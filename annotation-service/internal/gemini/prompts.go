package gemini

import "fmt"

// SystemInstruction is the base instruction for Gemini (from your llm.py)
const SystemInstruction = `Ты — высокоточный классификатор рисков для детей в сети. Твоя задача — проанализировать сообщение и выбрать ОДНУ наиболее подходящую категорию.
Ты должен отвечать ТОЛЬКО в формате JSON.`

// Categories list for prompt
const CategoriesText = `1: Склонение к сексуальным действиям (Груминг)
2: Угрозы, шантаж, вымогательство
3: Физическое насилие/Буллинг
4: Склонение к суициду/Самоповреждению
5: Склонение к опасным играм/действиям
6: Пропаганда запрещенных веществ
7: Финансовое мошенничество
8: Сбор личных данных (Фишинг)
9: Нейтральное общение`

// FewShotExamples provides examples for better classification
const FewShotExamples = `ПРИМЕРЫ (Few-Shot Context):
- Сообщение: "Пошли ко мне домой, никто не узнает. Пришли мне свое фото, это наш секрет." -> Категория: Склонение к сексуальным действиям (Груминг)
- Сообщение: "Если ты не сделаешь, как я сказал, я опубликую все твои секреты." -> Категория: Угрозы, шантаж, вымогательство
- Сообщение: "Ты идиот и неудачник, тебе лучше уйти из жизни." -> Категория: Склонение к суициду/Самоповреждению
- Сообщение: "Хочешь почувствовать свободу? Вот ссылка на магазин, где можно купить, это легально." -> Категория: Пропаганда запрещенных веществ
- Сообщение: "Ты выиграл! Чтобы получить приз, дай пароль и имя своей любимой собаки." -> Категория: Сбор личных данных (Фишинг)
- Сообщение: "Привет, как дела? Какую игру сейчас проходишь?" -> Категория: Нейтральное общение`

// BuildPrompt creates the full prompt for a message
func BuildPrompt(text string) string {
	return fmt.Sprintf(`СООБЩЕНИЕ ДЛЯ КЛАССИФИКАЦИИ: "%s"

КАТЕГОРИИ РИСКОВ (используй только эти названия):
%s

%s

ОТВЕТЬ ТОЛЬКО В СТРОГОМ ФОРМАТЕ JSON (чистый JSON без форматирования markdown):
{
  "category_name": "Название категории из списка",
  "category_id": НОМЕР_КАТЕГОРИИ_КАК_ЧИСЛО,
  "justification": "Краткое объяснение, почему выбрана эта категория."
}

ВАЖНО: category_id должен быть целым числом от 1 до 9, НЕ массивом!`, text, CategoriesText, FewShotExamples)
}
